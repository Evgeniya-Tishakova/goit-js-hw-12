{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCardTemplate = imgInfo => {\n    return `<li class=\"gallery-card\">\n    <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n    <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\" width=\"360\" height=\"200\"/>\n    </a>\n        <ul class=\"descr\">\n        <li class=\"descr-item\">\n        <h2 class=\"descr-title\">Likes</h2>\n        <p class=\"descr-title-item\">${imgInfo.likes}</p>\n        </li>\n        <li class=\"descr-item\">\n        <h2 class=\"descr-title\">Views</h2>\n        <p class=\"descr-title-item\">${imgInfo.views}</p>\n        </li>\n        <li class=\"descr-item\">\n        <h2 class=\"descr-title\">Comments</h2>\n        <p class=\"descr-title-item\">${imgInfo.comments}</p>\n        </li>\n        <li class=\"descr-item\">\n        <h2 class=\"descr-title\">Downloads</h2>\n        <p class=\"descr-title-item\">${imgInfo.downloads}</p>\n        </li>\n        </ul>\n      </li>`;\n  };","//Бібліотека Axios\nimport axios from 'axios';\n\n\n\n// export function getItemsBySearch(searchQuery) {\n//     return fetch(\n//       `https://pixabay.com/api/?q=${searchQuery}&key=48211636-c2e7af5b30d3e402d83d1fb79&image_type=photo&orientation=horizontal&safesearch=true&per_page=9`\n//     );\n//   }\n\n\n\n  export const getItemsBySearch = (searchQuery, page) => {\n\n    const searchParams = new URLSearchParams({\n        q: searchQuery,\n      key: '48211636-c2e7af5b30d3e402d83d1fb79',\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: page,\n      per_page: 15,\n    });\n\n    return axios.get(`https://pixabay.com/api/?${searchParams}`)\n  };","// Бібліотека Іzitoast\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// Бібліотека SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getItemsBySearch } from './js/pixabay-api';\nimport { createGalleryCardTemplate } from './js/render-functions';\n\n\n\n\nconst formEl = document.querySelector('.js-search-form');\nconst inputEl = document.querySelector('.js-search-input');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.button-load')\n\nloader.style.display = 'none';\nloadBtn.style.display = 'none';\n\nconst galleryModal = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionsDelay: 250,\n  animationSpeed: 500,\n  fadeSpeed: 500,\n  zoom: true,\n  scaleImageToRatio: true,\n  enableKeyboard: true,\n});\n\nlet page = 1;\nlet prevQuery = '';\n\nformEl.addEventListener('submit', async event => {\n  loadBtn.style.display = 'none';\n  try {\n    event.preventDefault();\n    loader.style.display = 'inline-block';\n  \n    const currentQuery = inputEl.value.trim();\n  \n    if (currentQuery === '') {\n      return iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no empty strings allowed in search field. Please, try again!',\n        messageColor: '#fafafb;',\n        position: 'topRight',\n        backgroundColor: '#ef4040',\n      });\n    }\n\n    if (currentQuery !== prevQuery) {\n      prevQuery = currentQuery;\n      page = 1\n    } else {\n      page++;\n    }\n  \n    const {data} = await getItemsBySearch(currentQuery, page);\n   \n        if (data.hits.length === 0) {\n          iziToast.show({\n            title: 'Error',\n            message:\n              'Sorry, there are no images matching your search query. Please, try again!',\n            messageColor: '#fafafb;',\n            position: 'topRight',\n            backgroundColor: '#ef4040',\n          });\n  \n          galleryEl.innerHTML = '';\n          loadBtn.style.display = 'none';\n          loader.style.display = 'none';\n          return;\n        }\n  \n      \n\n      const galleryTemplate = data.hits\n        .map(el => createGalleryCardTemplate(el))\n        .join('');\n      galleryEl.innerHTML = galleryTemplate;\n      galleryModal.refresh();\n      loadBtn.style.display = 'inline-block';\n        checkTotal(data.totalHits);\n        scrollDown();\n  } catch (err) {\nconsole.log(err)\n    iziToast.error({\n      message: 'Error fetching images. Please try again later.',\n      position: 'topRight',\n    });\n    loadBtn.style.display = 'none';\n  } \n  \n    formEl.reset();\n    loader.style.display = 'none';\n\n  });\n\n\nloadBtn.addEventListener('click', async (event) => {\n  loadBtn.style.display = 'none';\n\n  try {\n    event.preventDefault();\n    loader.style.display = 'inline-block';\n\n    page++;\n  \n    const {data} = await getItemsBySearch(prevQuery, page);\n   \n        if (data.hits.length === 0) {\n          iziToast.show({\n            title: 'Error',\n            message:\n              'Sorry, there are no images matching your search query. Please, try again!',\n            messageColor: '#fafafb;',\n            position: 'topRight',\n            backgroundColor: '#ef4040',\n          });\n  \n          loadBtn.style.display = 'none';\n          loader.style.display = 'none';\n          return;\n        }\n  \n      \n\n      const galleryTemplate = data.hits\n        .map(el => createGalleryCardTemplate(el))\n        .join('');\n      galleryEl.innerHTML += galleryTemplate;\n      galleryModal.refresh();\n      loadBtn.style.display = 'inline-block';\n      checkTotal(data.totalHits);\n      scrollDown();\n  } catch (err) {\n\n    iziToast.error({\n      message: 'Error fetching images. Please try again later.',\n      position: 'topRight',\n    });\n    loadBtn.style.display = 'none';\n  } \n  \n\n    loader.style.display = 'none';\n  })\n\n \n  function checkTotal(total) {\n    if (page * 15 >= total) {\n      loadBtn.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n  }\n\n  function scrollDown() {\n    let cardHeight = document.querySelector('.gallery-card').getBoundingClientRect().height;\n    console.log(document.body.scrollTop , Math.floor(cardHeight*2))\n    window.scrollBy({\n      top: document.body.scrollTop + Math.floor(cardHeight*2),\n      behavior : \"smooth\"\n    })\n  }"],"names":["createGalleryCardTemplate","imgInfo","getItemsBySearch","searchQuery","page","searchParams","axios","formEl","inputEl","galleryEl","loader","loadBtn","galleryModal","SimpleLightbox","prevQuery","event","currentQuery","iziToast","data","galleryTemplate","el","checkTotal","scrollDown","err","total","cardHeight"],"mappings":"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"}